# Configuring and Resetting MFA
<br>

[Setup Steps](mfa.md#setup-steps)

Multi-Factor Authentication (MFA) is required to access OpenScienceLab resources.

Currently, we support TOTP-based authentication, with plans to add hardware
key (ex. Yubikey) authentication in future updates.

## Watch: Log In and Set Up MFA
:::{iframe} https://www.youtube.com/embed/2c1X9qRnsSM?si=XKHtBBzrSDgnBJNQ
:::

## Before You Begin

A TOTP-enabled MFA application is required to use OpenScienceLab resources.
While the most widely utilized approach is through a smartphone application,
there are also several desktop clients that provide this functionality.

:::{note} MFA App Support

| Application             | Desktop Support | Android Support | iOS Support |
| --------------------    | --------------- | --------------- | ----------- |
| KeePassXc               |        ✅       |       ❌        |      ❌     |
| Enpass                  |        ✅       |       ✅        |      ✅     |
| Cisco Duo               |        ✅       |       ✅        |      ✅     |
| Authenticator.cc*       |        ✅       |       ✅        |      ✅     |
| Bitwarden**             |        ✅       |       ✅        |      ✅     |
| FreeOTP                 |        ❌       |       ✅        |      ✅     |
| Google Authenticator    |        ❌       |       ✅        |      ✅     |
| Microsoft Authenticator |        ❌       |       ✅        |      ✅     |
| Aegis Authenticator     |        ❌       |       ✅        |      ❌     |

\* Browser based

\*\* TOTP supported in paid version only
:::

---
## Setup Steps

1. Log into OpenScienceLab normally. Leave the "MFA" field on the login page blank.
1. Click "Configure New MFA Device" in the Navigation Bar at
    the top of the page.
1. Configure your MFA device:
    1. If using a smartphone application, scan the QR code using the
application's "Scan QR Code" feature.
    1. If using a desktop application, copy the OTP Secret into the "TOTP" field
1. Enter the current 6-digit MFA code generated by your application into the "Code 1" field
    on the "Configure New MFA Device" page.
1. When the code changes, enter the new code into the "Code 2" field on the same
    page and click the "Check MFA Codes" button.
1. If the check is successfull, navigate back to the home page by clicking "Home"
    in the Navigation Bar at the top of the page and continue using OpenScienceLab
    as normal.

---
## Resetting MFA

On occasion, you may wish or need to reconfigure MFA for your OSL account.

1. Navigate to [opensciencelab](https://opensciencelab.asf.alaska.edu/).
   
2. 
:::{figure} ../assets/reset_mfa.png
:align: left
:width: 350px

<p style="font-size: 14px;">Click the "Reset MFA" link on the sign in card</p>
:::

3.
:::{figure} ../assets/mfa_reset_form.png
:align: left
:width: 350px

Complete the MFA reset form.
:::

4.
:::{figure} ../assets/mfa_update_alert.png
:align: left
:width: 500px

An alert will appear directing you to click an emailed verification link within 60 minutes.
:::

5.
:::{figure} ../assets/mfa_reset_email.png
:align: left

Click the verification link in the email.
:::

6. Sign into OpenScienceLab, leaving the MFA field empty.
7. **Follow the Setup Steps above to setup a new MFA device.** You will not be able to access any labs until you setup a new MFA device.

---
## Troubleshooting

1. If the MFA Code check is not successful, there are two potential issues:
    1. One of the codes was mis-typed.
    1. The secret was not properly put into the MFA application.
1. Test again with another two *consecutive* codes, and if the verification step fails
    again, check that the OTP Secret on the page matches the secret in your application.
1. If all else fails, refresh the page. This will generate a new code, which you
    can then use to follow the same steps above.

For additional issues and further troubleshooting, please email
[uso@asf.alaska.edu](mailto:uso@asf.alaska.edu)



